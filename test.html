<button onclick="playBadGuy()"
    style="padding:20px; font-size:20px; cursor:pointer; background:#BADA55; border:none; border-radius:10px;">
    â–¶ Click to Preview "Bad Guy" Tone
</button>

<script>
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    const motif = [0, 0, 3, 5, 0, 0, 6, 5, 3]; // The Billie Eilish Logic

    function playBadGuy() {
        if (audioCtx.state === 'suspended') audioCtx.resume();

        motif.forEach((note, i) => {
            setTimeout(() => {
                const osc = audioCtx.createOscillator();
                const g = audioCtx.createGain();

                // We use a Square wave for Billie Eilish because it sounds like a bass synth
                osc.type = 'square';

                // Frequency calculation starting from a low G (Midi 43)
                osc.frequency.setValueAtTime(440 * Math.pow(2, ((43 + note) - 69) / 12), audioCtx.currentTime);

                g.gain.setValueAtTime(0, audioCtx.currentTime);
                g.gain.linearRampToValueAtTime(0.2, audioCtx.currentTime + 0.02);
                g.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.4);

                osc.connect(g);
                g.connect(audioCtx.destination);

                osc.start();
                osc.stop(audioCtx.currentTime + 0.5);
            }, i * 180); // The timing of the bass hook
        });
    }
</script>

Add the logic for the genereateAITone and lets see

async function generateAITone() {
const vibe = document.getElementById('vibe-input').value;
if (!vibe) return alert("Describe a vibe first!");

document.getElementById('note-display').innerText = "AI is thinking...";

// Updated Prompt for 15 notes (approx 10 seconds of music)
const prompt = `Translate this vibe: "${vibe}" into a 15-note ambient melody.
Return ONLY a JSON array of 15 integers (MIDI offsets).
No text, no markdown. Example: [0, 4, 7, 11, 12, 14, 16, 19, 21, 24, 26, 28, 31, 33, 36]`;

const res = await callGemini(prompt);

try {
const cleanJson = res.match(/\[.*\]/)[0];
const motif = JSON.parse(cleanJson);

// Save logic with 20-tone limit
const newAIAsset = {
id: Date.now(),
name: vibe.charAt(0).toUpperCase() + vibe.slice(1),
motif: motif,
timestamp: new Date().toLocaleTimeString()
};

let aiSaved = JSON.parse(localStorage.getItem('sb_ai_assets') || '[]');

// Add new asset to the START of the list
aiSaved.unshift(newAIAsset);

// THE ROLLING LIMIT: If more than 20, remove the oldest (the last one)
if (aiSaved.length > 20) {
aiSaved.pop();
}

localStorage.setItem('sb_ai_assets', JSON.stringify(aiSaved));

// Re-render the AI grid and play the new sound
renderAIAssets();
playAsset(motif, 10, "ai_playing"); // Plays for 10 seconds
document.getElementById('note-display').innerText = "AI Composed: " + vibe;

} catch (e) {
console.error("AI Error:", e);
alert("AI had trouble with that vibe. Try something else!");
document.getElementById('note-display').innerText = "Ready";
}
}